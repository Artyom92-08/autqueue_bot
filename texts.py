from __future__ import annotations
from datetime import date
from config import SETTINGS, CONTACTS_TEXT

# ะคัะฝะบัะธั ะดะปั ัะธัะพะฒะฐะฝะธั ัะบะฐะปั: [โโโโกโก]
def progress_bar(current: int, total: int = 10) -> str:
    if total <= 0: total = 10
    percent = current / total
    filled = int(10 * percent)
    filled = min(10, max(0, filled)) # ะพะณัะฐะฝะธัะธะฒะฐะตะผ ะพั 0 ะดะพ 10
    bar = "โ" * filled + "โก" * (10 - filled)
    return f"[{bar}]"

STATUS_VIEW = {
    "waiting":    ("โณ", "ะ ะพัะตัะตะดะธ"),
    "called":     ("๐", "ะะฐั ะฒัะทัะฒะฐัั"),
    "arrived":    ("๐", "ะั ะฝะฐ ะผะตััะต"),
    "in_service": ("๐ง", "ะ ัะตะผะพะฝัะต"),
    "parts_wait": ("๐ฆ", "ะะดัะผ ะดะตัะฐะปะธ"),
    "done":       ("โ", "ะะพัะพะฒะพ"),
    "canceled":   ("โ", "ะัะผะตะฝะฐ"),
    "no_show":    ("๐ซ", "ะะตัะฒะบะฐ"),
}

def welcome_text(load_count: int = 0) -> str:
    # ะะธััะตะผ ะทะฐะณััะทะบั ัะตัะฒะธัะฐ
    bar = progress_bar(load_count, SETTINGS.MAX_AT_SHOP)
    
    return (
        f"๐ <b>ะะฒัะพัะตัะฒะธั | ะญะปะตะบััะพะฝะฝะฐั ะพัะตัะตะดั</b>\n"
        f"โโโโโโโโโโโโโโโโโโ\n"
        f"๐ <b>ะะฐะณััะทะบะฐ ัะตะนัะฐั:</b>\n"
        f"{bar} {load_count}/{SETTINGS.MAX_AT_SHOP} ะฐะฒัะพ\n\n"
        f"๐ <b>ะกะตะณะพะดะฝั:</b> {SETTINGS.WORK_INFO}\n"
        f"โโโโโโโโโโโโโโโโโโ\n\n"
        "๐ค ะฏ ะฟะพะผะพะณั ะทะฐะฟะธัะฐัััั ะธ ะฒะพะฒัะตะผั ะฟะพะทะพะฒั ะฒะฐั ะฒ ะฑะพะบั.\n"
        "๐ <b>ะะฐะถะผะธัะต ะบะฝะพะฟะบั, ััะพะฑั ะฝะฐัะฐัั:</b>"
    )

def contacts_text() -> str:
    return (
        "๐ <b>ะะะจ ะะะะะก ะ ะะะะขะะะขะซ</b>\n"
        "โโโโโโโโโโโโโโโโโโ\n\n"
        f"๐ข <b>ะะดัะตั:</b>\n{SETTINGS.ADDRESS_TEXT}\n\n"
        f"๐ <b>ะขะตะปะตัะพะฝ:</b>\n{SETTINGS.PHONE_TEXT}\n\n"
        "๐ <b>ะะฐะถะผะธัะต ะบะฝะพะฟะบั, ััะพะฑั ะฟะพัััะพะธัั ะผะฐััััั:</b>"
    )

def booking_created_text(day: date, seq: int, car_text: str, issue_text: str, phone: str) -> str:
    return (
        "โ <b>ะะซ ะฃะกะะะจะะ ะะะะะกะะะซ!</b>\n"
        "โโโโโโโโโโโโโโโโโโ\n"
        f"๐ ะะฐัะฐ: <b>{day.strftime('%d.%m.%Y')}</b>\n"
        f"๐ซ ะะฐั ัะฐะปะพะฝ: <b>โ{seq}</b>\n"
        f"๐ ะะฒัะพ: <b>{car_text}</b>\n"
        "โโโโโโโโโโโโโโโโโโ\n\n"
        "๐ <b>ะงัะพ ะดะฐะปััะต?</b>\n"
        "ะ ะดะตะฝั ะทะฐะฟะธัะธ ั ะฟัะธัะปั ัะฒะตะดะพะผะปะตะฝะธะต. ะะต ะฟัะธะตะทะถะฐะนัะต ะฑะตะท ะฒัะทะพะฒะฐ."
    )

def live_created_need_eta_text(seq: int) -> str:
    return (
        "โก <b>ะกะะะงะะะฏ ะะะฏะะะ ะะะะะฏะขะ</b>\n"
        f"ะะฐั ะฝะพะผะตั: <b>โ{seq}</b>\n"
        "โโโโโโโโโโโโโโโโโโ\n"
        "โฑ <b>ะงะตัะตะท ัะบะพะปัะบะพ ะฒั ะฟัะธะตะดะตัะต?</b>\n"
        "ะะฐะฟะธัะธัะต ะฒัะตะผั ะธะปะธ ะฒัะฑะตัะธัะต ะบะฝะพะฟะบั ะฝะธะถะต:"
    )

def duplicate_active_text() -> str:
    return "โ๏ธ <b>ะะจะะะะ:</b> ะฃ ะฒะฐั ัะถะต ะตััั ะฐะบัะธะฒะฝะฐั ะทะฐะฟะธัั. ะะฐะฒะตััะธัะต ะตั ะธะปะธ ะพัะผะตะฝะธัะต."

def eta_request_text() -> str:
    return "โฑ <b>ะัะฑะตัะธัะต ะฒัะตะผั ะฟัะธะฑััะธั:</b>"

def time_passed_text() -> str:
    return "โ๏ธ <b>ะัะตะผั ะธััะตะบะปะพ.</b> ะฃะบะฐะถะธัะต ะบะพััะตะบัะฝะพะต ะฒัะตะผั."

def live_no_today_suggest_text(suggest_day: date) -> str:
    return (
        "๐ <b>ะกะตะณะพะดะฝั ะผะตัั ะฝะตั.</b>\n"
        f"ะะปะธะถะฐะนัะตะต ัะฒะพะฑะพะดะฝะพะต ะพะบะฝะพ: <b>{suggest_day.strftime('%d.%m.%Y')}</b>\n\n"
        "ะะฐะฟะธัะฐัั ะฒะฐั ะฝะฐ ััั ะดะฐัั?"
    )

def review_request_text() -> str:
    return (
        "๐ <b>ะะะะะะข ะะะะะะจะะ!</b>\n"
        "โโโโโโโโโโโโโโโโโโ\n"
        "ะะพะถะฐะปัะนััะฐ, ะพัะตะฝะธัะต ะบะฐัะตััะฒะพ ัะฐะฑะพัั.\n"
        "ะญัะพ ะทะฐะนะผะตั 1 ัะตะบัะฝะดั:"
    )
